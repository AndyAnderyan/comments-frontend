<article
  class="message-card"
  [class.message-card--right]="isMine"
  [class.pinned]="message.isPinned"
  [class.hidden]="message.isHidden"
>
  <header>
    <span class="author">{{ message.author.name }}</span>

    <div class="menu-container">
      <button
        class="chat-icon-button"
        type="button"
        aria-label="–û–ø—Ü—ñ—ó"
        (click)="toggleMenu($event)">
        <span class="icon icon-more"></span>
      </button>

      @if (isMenuOpen) {
        <div class="dropdown-menu">
          <button (click)="onAction('edit')">–†–µ–¥–∞–≥—É–≤–∞—Ç–∏</button>
          <button (click)="onAction('pin')">
            {{ message.isPinned ? '–í—ñ–¥–∫—Ä—ñ–ø–∏—Ç–∏' : '–ó–∞–∫—Ä—ñ–ø–∏—Ç–∏' }}
          </button>
          <button (click)="onAction('hide')">
            {{ message.isHidden ? '–ü–æ–∫–∞–∑–∞—Ç–∏' : '–ü—Ä–∏—Ö–æ–≤–∞—Ç–∏' }}
          </button>
          <div class="divider"></div>
          <button class="danger" (click)="onAction('delete')">–í–∏–¥–∞–ª–∏—Ç–∏</button>
        </div>
        <div class="menu-overlay" (click)="closeMenu()"></div>
      }
    </div>
  </header>

  @if (message.parent) {
    <div class="message-reply" (click)="onQuoteClick()" title="–ü–µ—Ä–µ–π—Ç–∏ –¥–æ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è">
      <div class="reply-line"></div>
      <div class="reply-content">
        <div class="reply-author">{{ message.parent!.author.name }}</div>
        <div class="reply-text">{{ message.parent!.text }}</div>
      </div>
    </div>
  }

  <p class="message-text">
    {{ message.text }}
  </p>

  <footer>
    <button class="link-button" type="button" (click)="onAction('reply')">–í—ñ–¥–ø–æ–≤—ñ—Å—Ç–∏</button>
    <div class="footer-right">
      <span class="message-time">{{ message.createdAt | date:'HH:mm' }}</span>
      @if (message.isPinned) {
        <span class="status-icon">üìå</span>
      }
    </div>
  </footer>
</article>
